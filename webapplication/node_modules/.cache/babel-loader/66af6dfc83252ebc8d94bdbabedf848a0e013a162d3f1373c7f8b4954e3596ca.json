{"ast":null,"code":"import React,{useEffect,useState,useRef,memo}from\"react\";import{Route}from\"react-router-dom\";//import { gettVehicleSnap } from \"../services/snapService\";\nimport{triggerSnap}from\"../services/snapService\";import io from\"socket.io-client\";import{APIProvider,Map,useMapsLibrary,useMap,Marker}from\"@vis.gl/react-google-maps\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const SocketClient=props=>{var _messages,_messages2,_messages3,_messages4;const{bus}=props.location.state||{};// Add default value for destructuring\nconst[messages,setMessages]=useState([]);useEffect(()=>{// Replace 'http://localhost:3001' with the URL where your Socket.IO server is running\nconst socket=io(\"http://13.51.79.199:3001\");// Event handler for receiving messages from the server\nsocket.on(bus===null||bus===void 0?void 0:bus.ThingName,message=>{//console.log(\"Received message from server:\", message);\nsetMessages(prevMessages=>[...prevMessages,message]);});// Event handler for connecting to the Socket.IO server\nsocket.on(\"connect\",()=>{console.log(\"Connected to Socket.IO server\");});// Event handler for potential errors\nsocket.on(\"error\",error=>{console.error(\"Socket.IO error:\",error);// Handle the error as needed\n});// Cleanup on component unmount\nreturn()=>{console.log(\"Disconnecting from Socket.IO server\");socket.disconnect();};},[]);// Empty dependency array ensures that the effect runs only once\n// Log the current state of messages whenever it changes\nuseEffect(()=>{//console.log(\"Current messages state:\", messages);\n},[messages]);//export default function LocationTracking() {\nconst cent={lat:7.291418,lng:80.636696};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:{height:\"80vh\",width:\"100%\"},children:/*#__PURE__*/_jsxs(APIProvider,{apiKey:\"AIzaSyD3iZ52fsbEPy64MJPTVxJLlePde16xAMc\",children:[/*#__PURE__*/_jsxs(Map,{center:cent,zoom:12,mapId:\"5e1c67490bdc79a3\",fullscreenControl:false//provideRouteAlternatives={true}\n,children:[messages.map((message,index)=>/*#__PURE__*/_jsx(DynamicMarker,{position:{lat:message===null||message===void 0?void 0:message.latitude,lng:message===null||message===void 0?void 0:message.longitude}},index)),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",style:{width:\"300px\",marginTop:\"70px\"},children:[/*#__PURE__*/_jsx(\"h1\",{style:{fontSize:\"20px\"},children:\"Current Speed:\"}),/*#__PURE__*/_jsx(\"p1\",{children:(_messages=messages[messages.length-1])===null||_messages===void 0?void 0:_messages.speed})]})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Directions,{endAddress:bus===null||bus===void 0?void 0:bus.SchoolAddress})})]})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",class:\"btn btn-primary\",onClick:()=>triggerSnap({thingName:bus===null||bus===void 0?void 0:bus.ThingName}),children:\"Snap\"}),/*#__PURE__*/_jsx(Route,{to:\"/vehicleSnap\",render:props=>/*#__PURE__*/_jsx(\"a\",{href:\"/vehicleSnap\",className:\"btn btn-primary\",onClick:()=>props.history.push(\"/vehicleSnap\",{bus}),children:\"See Last Snap\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",style:{width:\"200px\",marginLeft:\"500px\",marginTop:\"0px\"},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Position\"}),/*#__PURE__*/_jsxs(\"p1\",{children:[\"PositionX: \",(_messages2=messages[messages.length-1])===null||_messages2===void 0?void 0:_messages2.angularX]}),/*#__PURE__*/_jsxs(\"p1\",{children:[\"PositionY: \",(_messages3=messages[messages.length-1])===null||_messages3===void 0?void 0:_messages3.angularY]}),/*#__PURE__*/_jsxs(\"p1\",{children:[\"PositionZ: \",(_messages4=messages[messages.length-1])===null||_messages4===void 0?void 0:_messages4.angularZ]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Received AWS IoT Messages:\"}),/*#__PURE__*/_jsx(\"ul\",{children:messages.map((message,index)=>/*#__PURE__*/_jsx(\"li\",{children:JSON.stringify(message)},index))})]})]});};//};\nfunction Directions(_ref){let{endAddress}=_ref;const map=useMap();let distance=0;let duration=0;const routesLibrary=useMapsLibrary(\"routes\");const[directionService,setDirectionService]=useState();const[directionsRenderer,setDirectionsRenderer]=useState();const[routes,setRoutes]=useState([]);const[routeIndex,setRouteIndex]=useState(0);const selected=routes[routeIndex];const leg=selected===null||selected===void 0?void 0:selected.legs[0];//console.log(\"Selected legs are\", selected?.legs);\nconsole.log(\"Routes are\",routes);useEffect(()=>{if(!map||!routesLibrary)return;setDirectionService(new routesLibrary.DirectionsService());setDirectionsRenderer(new routesLibrary.DirectionsRenderer({map}));},[map,routesLibrary]);useEffect(()=>{if(!directionService||!directionsRenderer)return;const start={location:\"University of Peradeniya, Prof. E. O. E. Pereira Mawatha, Kandy\",stopover:true};const end={location:endAddress,stopover:true};const waypoints=[//{ location: \"31, Colombo Road, Piliyandala 10300\", stopover: true }, // Origin\n{location:\"Kingswood College, Randles Hill, Peradeniya Rd, Kandy 20000\",stopover:true},// Second destination\n{location:\"Sangaraja Mawatha, Kandy\",stopover:true},// Second destination\n{location:\"DS Senanayake Veediya, Kandy 20000\",stopover:true}//{ location: \"Maradana Rd, Colombo 01000\", stopover: true }, // First destination\n// Add more waypoints with stopover: true for each\n];directionService.route({origin:start.location,destination:end.location,waypoints:waypoints.map(waypoint=>({location:waypoint.location,stopover:waypoint.stopover})),// Exclude origin and destination from waypoints array\ntravelMode:\"DRIVING\",//provideRouteAlternatives: true,\noptimizeWaypoints:true}).then(Response=>{directionsRenderer.setDirections(Response);//console.log(\"response is\", Response);\nsetRoutes(Response.routes);});},[directionService,directionsRenderer]);//console.log(\"directionService\", directionService);\n//console.log(\"selected route is\", routes.selected);\nif(!leg)return null;{selected===null||selected===void 0?void 0:selected.legs.map(leg=>distance+=leg.distance.value);}{selected===null||selected===void 0?void 0:selected.legs.map(leg=>duration+=leg.duration.value);}const formattedDistance=(distance/1000).toFixed(1);const formattedDuration=(duration/60).toFixed(0);return/*#__PURE__*/_jsxs(\"div\",{className:\"card\",style:{width:\"200px\",marginTop:\"70px\"},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Directions\"}),/*#__PURE__*/_jsxs(\"p1\",{children:[\"Distance: \",formattedDistance,\" KM\"]}),/*#__PURE__*/_jsxs(\"p1\",{children:[\"Duration: \",formattedDuration,\" mins\"]})]});//return [leg.distance.text, leg.duration.text];\n}// const DynamicMarker = ({ position }) => {\n//   const map = useMap();\n//   const markerRef = useRef(null);\n//   useEffect(() => {\n//     if (!map || !position) return;\n//     // Create marker if it doesn't exist\n//     if (!markerRef.current) {\n//       markerRef.current = new window.google.maps.Marker({\n//         position,\n//         map,\n//       });\n//     } else {\n//       // Update marker position if it exists\n//       markerRef.current.setPosition(position);\n//     }\n//     return () => {\n//       // Cleanup marker on unmount\n//       markerRef.current.setMap(null);\n//     };\n//   }, [map, position]);\n//   return null; // No need to render anything for the marker\n// };\n// const DynamicMarker = memo(({ position }) => {\n//   // Memoize the DynamicMarker component\n//   const map = useMap();\n//   const markerRef = useRef(null);\n//   useEffect(() => {\n//     if (!map || !position) return;\n//     // Create marker if it doesn't exist or update position\n//     if (!markerRef.current) {\n//       markerRef.current = new window.google.maps.Marker({\n//         position,\n//         map,\n//       });\n//     } else {\n//       markerRef.current.setPosition(position);\n//     }\n//     return () => {\n//       // Cleanup marker on unmount\n//       markerRef.current.setMap(null);\n//     };\n//   }, [map, position]); // Only re-run effect if map or position changes\n//   return null; // No need to render anything for the marker\n// });\nconst DynamicMarker=/*#__PURE__*/memo(_ref2=>{let{position}=_ref2;const map=useMap();const markerRef=useRef(null);useEffect(()=>{if(!map||!position)return;if(!markerRef.current){markerRef.current=new window.google.maps.Marker({position,map});}else{// Animate marker to new position\nanimateMarker(markerRef.current,position);}return()=>{markerRef.current.setMap(null);};},[map,position]);const animateMarker=(marker,newPosition)=>{const start=marker.getPosition();const end=new window.google.maps.LatLng(newPosition.lat,newPosition.lng);let t=0;const duration=1000;// Animation duration in milliseconds\nconst animate=()=>{if(t<duration){const lat=start.lat()+(end.lat()-start.lat())*t/duration;const lng=start.lng()+(end.lng()-start.lng())*t/duration;const newPos=new window.google.maps.LatLng(lat,lng);marker.setPosition(newPos);t+=16;// 60 frames per second\nrequestAnimationFrame(animate);}else{marker.setPosition(end);}};animate();};return null;});// const AnimatedMarker = ({ positions }) => {\n//   const map = useMap();\n//   const markerRef = useRef(null);\n//   useEffect(() => {\n//     if (!map || !positions || positions.length === 0) return;\n//     const lat = positions[positions.length - 1].latitude;\n//     const lng = positions[positions.length - 1].longitude;\n//     const lastPosition = { lat, lng };\n//     if (!markerRef.current) {\n//       markerRef.current = new window.L.Marker(lastPosition).addTo(map);\n//     } else {\n//       animateMarker(markerRef?.current, lastPosition);\n//     }\n//     return () => {\n//       markerRef.current.remove();\n//     };\n//   }, [map, positions]);\n//   const animateMarker = (marker, newPosition) => {\n//     const start = marker.getLatLng();\n//     const end = new window.L.LatLng(newPosition.lat, newPosition.lng);\n//     let t = 0;\n//     const duration = 1000; // Animation duration in milliseconds\n//     const animate = () => {\n//       if (t < duration) {\n//         const lat = start.lat + ((end.lat - start.lat) * t) / duration;\n//         const lng = start.lng + ((end.lng - start.lng) * t) / duration;\n//         const newPos = new window.L.LatLng(lat, lng);\n//         marker.setLatLng(newPos);\n//         t += 16; // 60 frames per second\n//         requestAnimationFrame(animate);\n//       } else {\n//         marker.setLatLng(end);\n//       }\n//     };\n//     animate();\n//   };\n//   return null;\n// };\nexport default SocketClient;","map":{"version":3,"names":["React","useEffect","useState","useRef","memo","Route","triggerSnap","io","APIProvider","Map","useMapsLibrary","useMap","Marker","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","SocketClient","props","_messages","_messages2","_messages3","_messages4","bus","location","state","messages","setMessages","socket","on","ThingName","message","prevMessages","console","log","error","disconnect","cent","lat","lng","children","style","height","width","apiKey","center","zoom","mapId","fullscreenControl","map","index","DynamicMarker","position","latitude","longitude","className","marginTop","fontSize","length","speed","Directions","endAddress","SchoolAddress","type","class","onClick","thingName","to","render","href","history","push","marginLeft","angularX","angularY","angularZ","JSON","stringify","_ref","distance","duration","routesLibrary","directionService","setDirectionService","directionsRenderer","setDirectionsRenderer","routes","setRoutes","routeIndex","setRouteIndex","selected","leg","legs","DirectionsService","DirectionsRenderer","start","stopover","end","waypoints","route","origin","destination","waypoint","travelMode","optimizeWaypoints","then","Response","setDirections","value","formattedDistance","toFixed","formattedDuration","_ref2","markerRef","current","window","google","maps","animateMarker","setMap","marker","newPosition","getPosition","LatLng","t","animate","newPos","setPosition","requestAnimationFrame"],"sources":["C:/Users/ASUS/Documents/GitHub/e19-3yp-School-Van-Tracking-System/code/webapplication/src/components/LocationTracking.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef, memo } from \"react\";\r\nimport { Route } from \"react-router-dom\";\r\n//import { gettVehicleSnap } from \"../services/snapService\";\r\nimport { triggerSnap } from \"../services/snapService\";\r\nimport io from \"socket.io-client\";\r\nimport {\r\n  APIProvider,\r\n  Map,\r\n  useMapsLibrary,\r\n  useMap,\r\n  Marker,\r\n} from \"@vis.gl/react-google-maps\";\r\n\r\nconst SocketClient = (props) => {\r\n  const { bus } = props.location.state || {}; // Add default value for destructuring\r\n  const [messages, setMessages] = useState([]);\r\n\r\n  useEffect(() => {\r\n    // Replace 'http://localhost:3001' with the URL where your Socket.IO server is running\r\n    const socket = io(\"http://13.51.79.199:3001\");\r\n\r\n    // Event handler for receiving messages from the server\r\n    socket.on(bus?.ThingName, (message) => {\r\n      //console.log(\"Received message from server:\", message);\r\n      setMessages((prevMessages) => [...prevMessages, message]);\r\n    });\r\n\r\n    // Event handler for connecting to the Socket.IO server\r\n    socket.on(\"connect\", () => {\r\n      console.log(\"Connected to Socket.IO server\");\r\n    });\r\n\r\n    // Event handler for potential errors\r\n    socket.on(\"error\", (error) => {\r\n      console.error(\"Socket.IO error:\", error);\r\n      // Handle the error as needed\r\n    });\r\n\r\n    // Cleanup on component unmount\r\n    return () => {\r\n      console.log(\"Disconnecting from Socket.IO server\");\r\n      socket.disconnect();\r\n    };\r\n  }, []); // Empty dependency array ensures that the effect runs only once\r\n\r\n  // Log the current state of messages whenever it changes\r\n  useEffect(() => {\r\n    //console.log(\"Current messages state:\", messages);\r\n  }, [messages]);\r\n\r\n  //export default function LocationTracking() {\r\n  const cent = { lat: 7.291418, lng: 80.636696 };\r\n\r\n  return (\r\n    <>\r\n      <div style={{ height: \"80vh\", width: \"100%\" }}>\r\n        <APIProvider apiKey=\"AIzaSyD3iZ52fsbEPy64MJPTVxJLlePde16xAMc\">\r\n          <Map\r\n            center={cent}\r\n            zoom={12}\r\n            mapId=\"5e1c67490bdc79a3\"\r\n            fullscreenControl={false}\r\n            //provideRouteAlternatives={true}\r\n          >\r\n            {messages.map((message, index) => (\r\n              <DynamicMarker\r\n                key={index}\r\n                position={{ lat: message?.latitude, lng: message?.longitude }}\r\n              />\r\n            ))}\r\n            {/* <AnimatedMarker positions={messages} /> */}\r\n            <div className=\"card\" style={{ width: \"300px\", marginTop: \"70px\" }}>\r\n              <h1 style={{ fontSize: \"20px\" }}>Current Speed:</h1>\r\n              <p1>{messages[messages.length - 1]?.speed}</p1>\r\n            </div>\r\n          </Map>\r\n          <div>\r\n            <Directions endAddress={bus?.SchoolAddress} />\r\n          </div>\r\n        </APIProvider>\r\n      </div>\r\n\r\n      {/* <div className=\"card\" style={{ width: \"200px\" }}>\r\n        <h1>Directions</h1>\r\n        <p1>Distance: {Directions(bus?.SchoolAddress)?.[0]}</p1>\r\n        <p1>Duration: {Directions(bus?.SchoolAddress)?.[1]}</p1>\r\n      </div> */}\r\n      <button\r\n        type=\"button\"\r\n        class=\"btn btn-primary\"\r\n        onClick={() => triggerSnap({ thingName: bus?.ThingName })}\r\n      >\r\n        Snap\r\n      </button>\r\n      <Route\r\n        to=\"/vehicleSnap\"\r\n        render={(props) => (\r\n          <a\r\n            href=\"/vehicleSnap\"\r\n            className=\"btn btn-primary\"\r\n            onClick={() => props.history.push(\"/vehicleSnap\", { bus })}\r\n          >\r\n            See Last Snap\r\n          </a>\r\n        )}\r\n      />\r\n      <div\r\n        className=\"card\"\r\n        style={{ width: \"200px\", marginLeft: \"500px\", marginTop: \"0px\" }}\r\n      >\r\n        <h1>Position</h1>\r\n        <p1>PositionX: {messages[messages.length - 1]?.angularX}</p1>\r\n        <p1>PositionY: {messages[messages.length - 1]?.angularY}</p1>\r\n        <p1>PositionZ: {messages[messages.length - 1]?.angularZ}</p1>\r\n      </div>\r\n      <div>\r\n        <h1>Received AWS IoT Messages:</h1>\r\n        <ul>\r\n          {messages.map((message, index) => (\r\n            <li key={index}>{JSON.stringify(message)}</li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n//};\r\n\r\nfunction Directions({ endAddress }) {\r\n  const map = useMap();\r\n  let distance = 0;\r\n  let duration = 0;\r\n  const routesLibrary = useMapsLibrary(\"routes\");\r\n  const [directionService, setDirectionService] = useState();\r\n  const [directionsRenderer, setDirectionsRenderer] = useState();\r\n  const [routes, setRoutes] = useState([]);\r\n  const [routeIndex, setRouteIndex] = useState(0);\r\n  const selected = routes[routeIndex];\r\n  const leg = selected?.legs[0];\r\n  //console.log(\"Selected legs are\", selected?.legs);\r\n  console.log(\"Routes are\", routes);\r\n\r\n  useEffect(() => {\r\n    if (!map || !routesLibrary) return;\r\n    setDirectionService(new routesLibrary.DirectionsService());\r\n    setDirectionsRenderer(new routesLibrary.DirectionsRenderer({ map }));\r\n  }, [map, routesLibrary]);\r\n\r\n  useEffect(() => {\r\n    if (!directionService || !directionsRenderer) return;\r\n\r\n    const start = {\r\n      location:\r\n        \"University of Peradeniya, Prof. E. O. E. Pereira Mawatha, Kandy\",\r\n      stopover: true,\r\n    };\r\n    const end = { location: endAddress, stopover: true };\r\n\r\n    const waypoints = [\r\n      //{ location: \"31, Colombo Road, Piliyandala 10300\", stopover: true }, // Origin\r\n      {\r\n        location: \"Kingswood College, Randles Hill, Peradeniya Rd, Kandy 20000\",\r\n        stopover: true,\r\n      }, // Second destination\r\n      {\r\n        location: \"Sangaraja Mawatha, Kandy\",\r\n        stopover: true,\r\n      }, // Second destination\r\n      { location: \"DS Senanayake Veediya, Kandy 20000\", stopover: true },\r\n      //{ location: \"Maradana Rd, Colombo 01000\", stopover: true }, // First destination\r\n      // Add more waypoints with stopover: true for each\r\n    ];\r\n\r\n    directionService\r\n      .route({\r\n        origin: start.location,\r\n        destination: end.location,\r\n        waypoints: waypoints.map((waypoint) => ({\r\n          location: waypoint.location,\r\n          stopover: waypoint.stopover,\r\n        })), // Exclude origin and destination from waypoints array\r\n        travelMode: \"DRIVING\",\r\n        //provideRouteAlternatives: true,\r\n        optimizeWaypoints: true,\r\n      })\r\n      .then((Response) => {\r\n        directionsRenderer.setDirections(Response);\r\n        //console.log(\"response is\", Response);\r\n        setRoutes(Response.routes);\r\n      });\r\n  }, [directionService, directionsRenderer]);\r\n\r\n  //console.log(\"directionService\", directionService);\r\n  //console.log(\"selected route is\", routes.selected);\r\n\r\n  if (!leg) return null;\r\n\r\n  {\r\n    selected?.legs.map((leg) => (distance += leg.distance.value));\r\n  }\r\n\r\n  {\r\n    selected?.legs.map((leg) => (duration += leg.duration.value));\r\n  }\r\n\r\n  const formattedDistance = (distance / 1000).toFixed(1);\r\n  const formattedDuration = (duration / 60).toFixed(0);\r\n\r\n  return (\r\n    <div className=\"card\" style={{ width: \"200px\", marginTop: \"70px\" }}>\r\n      <h1>Directions</h1>\r\n      <p1>Distance: {formattedDistance} KM</p1>\r\n      <p1>Duration: {formattedDuration} mins</p1>\r\n    </div>\r\n  );\r\n\r\n  //return [leg.distance.text, leg.duration.text];\r\n}\r\n\r\n// const DynamicMarker = ({ position }) => {\r\n//   const map = useMap();\r\n//   const markerRef = useRef(null);\r\n\r\n//   useEffect(() => {\r\n//     if (!map || !position) return;\r\n\r\n//     // Create marker if it doesn't exist\r\n//     if (!markerRef.current) {\r\n//       markerRef.current = new window.google.maps.Marker({\r\n//         position,\r\n//         map,\r\n//       });\r\n//     } else {\r\n//       // Update marker position if it exists\r\n//       markerRef.current.setPosition(position);\r\n//     }\r\n\r\n//     return () => {\r\n//       // Cleanup marker on unmount\r\n//       markerRef.current.setMap(null);\r\n//     };\r\n//   }, [map, position]);\r\n\r\n//   return null; // No need to render anything for the marker\r\n// };\r\n\r\n// const DynamicMarker = memo(({ position }) => {\r\n//   // Memoize the DynamicMarker component\r\n//   const map = useMap();\r\n//   const markerRef = useRef(null);\r\n\r\n//   useEffect(() => {\r\n//     if (!map || !position) return;\r\n\r\n//     // Create marker if it doesn't exist or update position\r\n//     if (!markerRef.current) {\r\n//       markerRef.current = new window.google.maps.Marker({\r\n//         position,\r\n//         map,\r\n//       });\r\n//     } else {\r\n//       markerRef.current.setPosition(position);\r\n//     }\r\n\r\n//     return () => {\r\n//       // Cleanup marker on unmount\r\n//       markerRef.current.setMap(null);\r\n//     };\r\n//   }, [map, position]); // Only re-run effect if map or position changes\r\n\r\n//   return null; // No need to render anything for the marker\r\n// });\r\n\r\nconst DynamicMarker = memo(({ position }) => {\r\n  const map = useMap();\r\n  const markerRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (!map || !position) return;\r\n\r\n    if (!markerRef.current) {\r\n      markerRef.current = new window.google.maps.Marker({\r\n        position,\r\n        map,\r\n      });\r\n    } else {\r\n      // Animate marker to new position\r\n      animateMarker(markerRef.current, position);\r\n    }\r\n\r\n    return () => {\r\n      markerRef.current.setMap(null);\r\n    };\r\n  }, [map, position]);\r\n\r\n  const animateMarker = (marker, newPosition) => {\r\n    const start = marker.getPosition();\r\n    const end = new window.google.maps.LatLng(newPosition.lat, newPosition.lng);\r\n    let t = 0;\r\n    const duration = 1000; // Animation duration in milliseconds\r\n\r\n    const animate = () => {\r\n      if (t < duration) {\r\n        const lat = start.lat() + ((end.lat() - start.lat()) * t) / duration;\r\n        const lng = start.lng() + ((end.lng() - start.lng()) * t) / duration;\r\n        const newPos = new window.google.maps.LatLng(lat, lng);\r\n        marker.setPosition(newPos);\r\n        t += 16; // 60 frames per second\r\n        requestAnimationFrame(animate);\r\n      } else {\r\n        marker.setPosition(end);\r\n      }\r\n    };\r\n\r\n    animate();\r\n  };\r\n\r\n  return null;\r\n});\r\n\r\n// const AnimatedMarker = ({ positions }) => {\r\n//   const map = useMap();\r\n//   const markerRef = useRef(null);\r\n\r\n//   useEffect(() => {\r\n//     if (!map || !positions || positions.length === 0) return;\r\n\r\n//     const lat = positions[positions.length - 1].latitude;\r\n//     const lng = positions[positions.length - 1].longitude;\r\n//     const lastPosition = { lat, lng };\r\n//     if (!markerRef.current) {\r\n//       markerRef.current = new window.L.Marker(lastPosition).addTo(map);\r\n//     } else {\r\n//       animateMarker(markerRef?.current, lastPosition);\r\n//     }\r\n\r\n//     return () => {\r\n//       markerRef.current.remove();\r\n//     };\r\n//   }, [map, positions]);\r\n\r\n//   const animateMarker = (marker, newPosition) => {\r\n//     const start = marker.getLatLng();\r\n//     const end = new window.L.LatLng(newPosition.lat, newPosition.lng);\r\n//     let t = 0;\r\n//     const duration = 1000; // Animation duration in milliseconds\r\n\r\n//     const animate = () => {\r\n//       if (t < duration) {\r\n//         const lat = start.lat + ((end.lat - start.lat) * t) / duration;\r\n//         const lng = start.lng + ((end.lng - start.lng) * t) / duration;\r\n//         const newPos = new window.L.LatLng(lat, lng);\r\n//         marker.setLatLng(newPos);\r\n//         t += 16; // 60 frames per second\r\n//         requestAnimationFrame(animate);\r\n//       } else {\r\n//         marker.setLatLng(end);\r\n//       }\r\n//     };\r\n\r\n//     animate();\r\n//   };\r\n\r\n//   return null;\r\n// };\r\n\r\nexport default SocketClient;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}